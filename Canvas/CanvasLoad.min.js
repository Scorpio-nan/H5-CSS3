function Random(t,i){return~~(Math.random()*(i-t+1)+t)}function Doarc(t){return t*Math.PI/180}function CanvasUpload(t,i){i||(i={});var s=this;this.dom=document.querySelector(t),this.dom.style.background=i.bg?i.bg:"rgba(0,0,0,0.7)",this.c=this.dom.getContext("2d"),this.w=window.innerWidth,this.h=window.innerHeight,this.dom.width=this.w,this.dom.height=this.h,this.x=i.x?i.x:this.w/2+5,this.y=i.y?i.y:this.h/2+22,this.r=i.r?i.r:80,this.speed=i.speed?i.speed:5,this.rotation=i.rotation?i.rotation:0,this.angleStart=i.angleStart?i.angleStart:270,this.angleEnd=i.angleEnd?angleEnd:90,this.hue=i.hue?i.hue:200,this.thickness=i.thickness?i.thickness:18,this.blur=i.blur?i.blur:25,this.particles=[],this.particleMax=100,window.onresize=function(t){s.dom.width=s.w=this.innerWidth,s.dom.height=s.h=this.innerHeight},this.c.shadowBlur=this.blur,this.c.shadowColor="hsla("+this.hue+", 80%, 60%, 1)",this.c.lineCap="round";var h=this.c.createLinearGradient(0,-this.r,0,this.r);h.addColorStop(0,"hsla("+this.hue+", 60%, 50%, .25)"),h.addColorStop(1,"hsla("+this.hue+", 60%, 50%, 0)"),this.gradient1=h;var e=this.c.createLinearGradient(0,-this.r,0,this.r);e.addColorStop(0,"hsla("+this.hue+", 100%, 50%, 0)"),e.addColorStop(.1,"hsla("+this.hue+", 100%, 100%, .7)"),e.addColorStop(1,"hsla("+this.hue+", 100%, 50%, 0)"),this.gradient2=e,this.timer=setInterval(function(){s.__proto__.loop(s)},10)}CanvasUpload.prototype={constructor:CanvasUpload,updateCircle:function(){this.rotation<360?this.rotation+=this.speed:this.rotation=0},renderCircle:function(){this.c.save(),this.c.translate(this.x,this.y),this.c.rotate(Doarc(this.rotation)),this.c.beginPath(),this.c.arc(0,0,this.r,Doarc(this.angleStart),Doarc(this.angleEnd),!0),this.c.lineWidth=this.thickness,this.c.strokeStyle=this.gradient1,this.c.stroke(),this.c.restore()},renderCircleBorder:function(){this.c.save(),this.c.translate(this.x,this.y),this.c.rotate(Doarc(this.rotation)),this.c.beginPath(),this.c.arc(0,0,this.r+this.thickness/2,Doarc(this.angleStart),Doarc(this.angleEnd),!0),this.c.lineWidth=2,this.c.strokeStyle=this.gradient2,this.c.stroke(),this.c.restore()},renderCircleFlare:function(){this.c.save(),this.c.translate(this.x,this.y),this.c.rotate(Doarc(this.rotation+185)),this.c.scale(1,1),this.c.beginPath(),this.c.arc(0,this.r,30,0,2*Math.PI,!1),this.c.closePath();var t=this.c.createRadialGradient(0,this.r,0,0,this.r,30);t.addColorStop(0,"hsla(330, 50%, 50%, .35)"),t.addColorStop(1,"hsla(330, 50%, 50%, 0)"),this.c.fillStyle=t,this.c.fill(),this.c.restore()},renderCircleFlare2:function(){this.c.save(),this.c.translate(this.x,this.y),this.c.rotate(Doarc(this.rotation+165)),this.c.scale(1.5,1),this.c.beginPath(),this.c.arc(0,this.r,25,0,2*Math.PI,!1),this.c.closePath();var t=this.c.createRadialGradient(0,this.r,0,0,this.r,25);t.addColorStop(0,"hsla(30, 100%, 50%, .2)"),t.addColorStop(1,"hsla(30, 100%, 50%, 0)"),this.c.fillStyle=t,this.c.fill(),this.c.restore()},createParticles:function(){this.particles.length<this.particleMax&&this.particles.push({x:this.x+this.r*Math.cos(Doarc(this.rotation-85))+(Random(0,2*this.thickness)-this.thickness),y:this.y+this.r*Math.sin(Doarc(this.rotation-85))+(Random(0,2*this.thickness)-this.thickness),vx:(Random(0,100)-50)/1e3,vy:(Random(0,100)-50)/1e3,r:Random(1,6)/2,alpha:Random(10,20)/100})},updateParticles:function(){for(var t=this.particles.length;t--;){var i=this.particles[t];i.vx+=(Random(0,100)-50)/750,i.vy+=(Random(0,100)-50)/750,i.x+=i.vx,i.y+=i.vy,i.alpha-=.01,i.alpha<.02&&this.particles.splice(t,1)}},renderParticles:function(){for(var t=this.particles.length;t--;){var i=this.particles[t];this.c.beginPath(),this.c.fillRect(i.x,i.y,i.r,i.r),this.c.closePath(),this.c.fillStyle="hsla(0, 0%, 100%, "+i.alpha+")"}},clear:function(){this.c.globalCompositeOperation="destination-out",this.c.fillStyle="rgba(0, 0, 0, .1)",this.c.fillRect(0,0,this.w,this.h),this.c.globalCompositeOperation="lighter"},loop:function(t){t.clear(),t.updateCircle(),t.renderCircle(),t.renderCircleBorder(),t.renderCircleFlare(),t.renderCircleFlare2(),t.createParticles(),t.updateParticles(),t.renderParticles()},stop:function(){clearInterval(this.timer),document.body.remove(this.dom)}};